@page
@using System.Data;
@model IndexModel
@{
	ViewData["Title"] = "Home page";
}

<div class="text-center">
	<h1 class="display-4">Excel Uploader</h1>

</div>

<form method="post" enctype="multipart/form-data">
	<div class="form-group">
		<label for="upload">Select Excel File:</label>
		<input type="file" id="upload" name="Upload" class="form-control-file" />
	</div>
	<button type="submit" class="btn btn-primary">Upload</button>

</form>


<div class="alert alert-info mt-4">
	@TempData["Message"]
</div>

@if (Model.cat01Data != null)//&& Model.CapexData.Rows.Count > 0)
{
	<h3>Category 01</h3>
	<table class="table">
		<thead>
			<tr>
				@foreach (DataColumn column in Model.cat01Data.Columns)
				{
					<th>@column.ColumnName</th>
				}
			</tr>
		</thead>
		<tbody>
			@foreach (DataRow row in Model.cat01Data.Rows)
			{
				<tr>
					@foreach (var item in row.ItemArray)
					{
						<td>@item.ToString()</td>
					}
				</tr>
			}
		</tbody>
	</table>
}

@if (Model.cat02Data != null) //&& Model.OpexData.Rows.Count > 0)
{
	<h3>Category 02</h3>
	<table class="table">
		<thead>
			<tr>
				@foreach (DataColumn column in Model.cat02Data.Columns)
				{
					<th>@column.ColumnName</th>
				}
			</tr>
		</thead>
		<tbody>
			@foreach (DataRow row in Model.cat02Data.Rows)
			{
				<tr>
					@foreach (var item in row.ItemArray)
					{
						<td>@item.ToString()</td>
					}
				</tr>
			}
		</tbody>
	</table>
}




